export const LIFE_EXPECTANCY_DATA: Record<string, number[]> = {
    "Lesotho": [57.38, 47.40, 12.86, 6.53],
    "Nigeria": [54.46, 48.48, 12.14, 5.23],
    "Central African Republic": [57.41, 49.30, 12.85, 6.28],
    "Chad": [55.07, 48.75, 12.25, 5.29],
    "Palestine": [65.17, 53.48, 15.92, 7.08],
    "Kenya": [63.65, 51.83, 14.02, 6.96],
    "South Sudan": [57.62, 50.95, 12.98, 5.63],
    "Zimbabwe": [62.77, 51.28, 13.22, 6.33],
    "Somalia": [58.82, 52.09, 13.49, 5.85],
    "Eswatini": [64.12, 52.96, 14.24, 6.94],
    "Ivory Coast": [61.94, 52.03, 13.15, 6.27],
    "South Africa": [66.14, 54.01, 14.96, 7.57],
    "Benin": [60.77, 52.63, 13.38, 5.79],
    "DR Congo": [61.90, 53.31, 13.60, 5.88],
    "Burundi": [63.65, 53.43, 13.65, 5.91],
    "Guinea": [60.74, 53.48, 13.63, 5.88],
    "Burkina Faso": [61.09, 52.31, 12.38, 4.77],
    "Liberia": [62.16, 52.54, 12.38, 5.36],
    "Mali": [60.44, 52.63, 12.34, 4.75],
    "Tanzania": [67.00, 55.15, 14.75, 7.30],
    "Uganda": [68.25, 56.46, 16.02, 8.48],
    "Madagascar": [63.63, 54.40, 13.92, 6.00],
    "Namibia": [67.39, 55.38, 14.88, 7.38],
    "Togo": [62.74, 52.80, 12.27, 4.71],
    "Ghana": [65.50, 54.58, 14.00, 6.05],
    "Micronesia": [67.20, 54.15, 13.42, 6.14],
    "Congo": [65.77, 53.96, 13.19, 5.83],
    "Guinea-Bissau": [64.08, 54.60, 13.67, 6.10],
    "Gambia": [65.86, 55.08, 14.13, 6.08],
    "Mozambique": [63.61, 53.57, 12.61, 5.20],
    "Cameroon": [63.70, 54.04, 13.07, 5.65],
    "Equatorial Guinea": [63.71, 54.21, 13.21, 5.82],
    "Ukraine": [73.42, 59.04, 17.87, 9.88],
    "Angola": [64.62, 54.67, 13.45, 5.98],
    "Djibouti": [65.99, 55.57, 14.33, 6.19],
    "Haiti": [64.94, 54.42, 13.13, 5.54],
    "Sudan": [66.33, 55.76, 14.44, 6.23],
    "Russia": [73.15, 58.59, 17.12, 8.58],
    "Malawi": [67.35, 55.55, 14.05, 6.47],
    "Papua New Guinea": [66.13, 54.35, 12.82, 5.63],
    "São Tomé and Príncipe": [69.72, 55.95, 14.33, 6.57],
    "Sierra Leone": [61.79, 54.24, 12.59, 5.34],
    "Ethiopia": [67.31, 56.39, 14.63, 6.31],
    "Myanmar": [66.89, 55.18, 13.36, 5.62],
    "Guyana": [70.18, 57.18, 15.33, 7.93],
    "Rwanda": [67.78, 55.78, 13.92, 6.22],
    "Gabon": [68.34, 56.41, 14.50, 6.69],
    "Niger": [61.18, 54.93, 12.95, 4.96],
    "El Salvador": [72.10, 58.13, 16.12, 7.04],
    "Greenland": [70.06, 56.71, 14.64, 6.36],
    "Eritrea": [68.62, 56.98, 14.79, 6.38],
    "Afghanistan": [66.03, 55.53, 13.33, 5.61],
    "Bolivia": [68.58, 57.22, 14.94, 7.02],
    "Botswana": [69.16, 57.27, 14.88, 7.15],
    "Comoros": [66.78, 55.51, 13.12, 5.65],
    "Fiji": [67.32, 54.52, 12.13, 5.53],
    "Kiribati": [66.47, 55.86, 13.44, 5.68],
    "Mongolia": [71.73, 57.81, 15.23, 6.79],
    "Venezuela": [72.51, 59.14, 16.53, 6.89],
    "Moldova": [71.20, 57.32, 14.70, 6.95],
    "Zambia": [66.35, 55.52, 12.84, 5.29],
    "Thailand": [76.41, 62.31, 19.61, 9.65],
    "Saint Vincent and the Grenadines": [71.23, 57.51, 14.80, 6.59],
    "Libya": [69.34, 58.12, 15.41, 6.82],
    "Cambodia": [70.67, 58.00, 15.20, 6.55],
    "Bahamas": [74.55, 60.63, 17.77, 9.09],
    "Timor-Leste": [67.69, 56.45, 13.52, 5.68],
    "Guam": [77.21, 63.35, 20.29, 10.92],
    "Philippines": [69.83, 57.09, 14.02, 6.12],
    "Mauritania": [68.48, 56.59, 13.51, 5.81],
    "Suriname": [73.63, 60.04, 16.89, 8.28],
    "Guatemala": [72.60, 59.39, 16.15, 6.64],
    "Senegal": [68.68, 56.78, 13.53, 5.15],
    "Samoa": [71.70, 58.09, 14.74, 6.57],
    "Laos": [68.96, 57.15, 13.75, 5.76],
    "Tonga": [72.89, 58.87, 15.41, 6.96],
    "Indonesia": [71.15, 57.91, 14.44, 6.36],
    "Mexico": [75.07, 61.17, 17.70, 8.29],
    "Pakistan": [67.65, 57.28, 13.80, 5.76],
    "Solomon Islands": [70.53, 57.19, 13.70, 5.71],
    "Belarus": [74.43, 59.69, 16.19, 7.13],
    "Trinidad and Tobago": [73.49, 59.85, 16.34, 6.89],
    "Yemen": [69.30, 57.52, 13.95, 5.83],
    "Vanuatu": [71.48, 58.01, 14.43, 6.25],
    "Jamaica": [71.48, 58.10, 14.51, 6.34],
    "Mauritius": [74.93, 61.14, 17.48, 8.61],
    "Nepal": [70.35, 57.61, 13.86, 5.79],
    "Uzbekistan": [72.39, 58.60, 14.77, 6.12],
    "India": [72.00, 59.29, 15.44, 7.53],
    "Seychelles": [72.86, 59.07, 15.19, 6.78],
    "World": [73.17, 61.46, 17.57, 8.31],
    "Lithuania": [76.03, 61.35, 17.38, 8.21],
    "Kyrgyzstan": [71.68, 58.08, 14.09, 5.87],
    "Kazakhstan": [74.40, 60.27, 16.26, 7.35],
    "Belize": [73.57, 59.45, 15.42, 7.01],
    "Turkmenistan": [70.07, 58.17, 14.14, 6.04],
    "Paraguay": [73.84, 60.29, 16.25, 7.46],
    "Latvia": [76.19, 61.54, 17.49, 8.27],
    "Dominican Republic": [73.72, 61.19, 17.13, 8.31],
    "Grenada": [75.20, 61.62, 17.48, 8.92],
    "Georgia": [74.50, 60.31, 16.16, 7.32],
    "Honduras": [72.88, 59.23, 15.09, 6.67],
    "Saint Lucia": [72.70, 59.17, 15.00, 6.61],
    "Vietnam": [74.59, 61.58, 17.37, 8.02],
    "Brazil": [75.85, 62.02, 17.79, 7.77],
    "Syria": [72.12, 59.20, 14.88, 6.27],
    "North Korea": [73.64, 60.40, 15.99, 6.63],
    "Western Sahara": [71.39, 58.73, 14.33, 5.98],
    "Nicaragua": [74.95, 61.20, 16.75, 7.04],
    "Dominica": [71.13, 58.80, 14.23, 6.10],
    "Peru": [77.74, 64.11, 19.54, 9.73],
    "Bangladesh": [74.67, 62.11, 17.52, 8.51],
    "Romania": [75.94, 61.48, 16.86, 7.55],
    "Bulgaria": [75.64, 61.16, 16.54, 7.36],
    "Iraq": [72.32, 59.27, 14.60, 6.11],
    "Ecuador": [77.39, 63.51, 18.75, 8.34],
    "Tajikistan": [71.79, 59.16, 14.38, 6.12],
    "Malaysia": [76.66, 62.39, 17.60, 9.02],
    "Uruguay": [78.14, 63.75, 18.94, 9.84],
    "Egypt": [71.63, 58.16, 13.33, 5.46],
    "United States": [79.30, 64.88, 20.00, 9.61],
    "Cayman Islands": [80.36, 65.58, 20.64, 9.82],
    "Brunei": [75.33, 61.21, 16.19, 7.14],
    "U.S. Virgin Islands": [75.47, 61.17, 16.13, 7.20],
    "Antigua and Barbuda": [77.60, 63.46, 18.41, 8.78],
    "Bhutan": [72.97, 59.89, 14.81, 6.21],
    "Argentina": [77.39, 63.32, 18.11, 8.76],
    "Hungary": [77.02, 62.40, 17.16, 8.00],
    "Poland": [78.63, 63.98, 18.70, 9.06],
    "Armenia": [75.68, 61.53, 16.19, 7.12],
    "Cape Verde": [76.06, 62.05, 16.65, 7.05],
    "Cuba": [78.08, 63.66, 18.23, 9.13],
    "Barbados": [76.18, 62.08, 16.65, 6.76],
    "Colombia": [77.72, 63.85, 18.38, 7.80],
    "Serbia": [76.77, 62.21, 16.73, 8.03],
    "Panama": [79.59, 66.09, 20.58, 10.06],
    "Azerbaijan": [74.43, 60.93, 15.38, 6.57],
    "Estonia": [79.15, 64.41, 18.80, 9.02],
    "New Caledonia": [78.77, 64.78, 19.14, 7.64],
    "Montenegro": [77.09, 62.48, 16.82, 7.57],
    "Slovakia": [78.34, 63.85, 18.16, 8.43],
    "Taiwan": [80.56, 65.96, 20.18, 9.08],
    "Costa Rica": [80.80, 66.53, 20.74, 9.81],
    "Morocco": [75.31, 61.81, 15.96, 6.87],
    "Mayotte": [76.05, 62.05, 16.18, 6.97],
    "Guadeloupe": [82.05, 67.85, 21.95, 11.11],
    "Curaçao": [76.80, 62.77, 16.86, 7.56],
    "Turkey": [77.16, 63.52, 17.58, 7.75],
    "Bosnia and Herzegovina": [77.85, 63.33, 17.38, 8.29],
    "Sri Lanka": [77.48, 63.05, 17.01, 7.62],
    "Chile": [81.17, 66.68, 20.59, 10.11],
    "Tunisia": [76.51, 62.50, 16.39, 7.09],
    "French Guiana": [76.98, 62.88, 16.70, 7.01],
    "Saudi Arabia": [78.73, 64.41, 18.21, 8.13],
    "Aruba": [76.35, 62.61, 16.40, 6.17],
    "China": [77.95, 63.69, 17.45, 7.52],
    "Iran": [77.65, 63.83, 17.59, 6.98],
    "Puerto Rico": [81.69, 67.24, 20.88, 10.51],
    "Croatia": [78.58, 63.95, 17.58, 7.68],
    "North Macedonia": [77.39, 62.92, 16.50, 7.18],
    "Czech Republic": [79.83, 65.11, 18.66, 8.47],
    "United Kingdom": [81.30, 66.70, 20.19, 9.30],
    "Canada": [82.63, 68.09, 21.48, 10.32],
    "France": [83.33, 68.72, 22.03, 10.61],
    "Jordan": [77.81, 64.02, 17.32, 7.64],
    "Algeria": [76.26, 63.09, 16.38, 6.96],
    "Albania": [79.60, 65.49, 18.76, 8.24],
    "Bermuda": [82.31, 67.56, 20.81, 9.82],
    "Isle of Man": [81.00, 67.31, 20.56, 9.78],
    "Lebanon": [77.82, 64.41, 17.64, 7.81],
    "Portugal": [82.36, 67.68, 20.88, 9.61],
    "New Zealand": [82.09, 67.63, 20.77, 9.42],
    "Finland": [81.91, 67.19, 20.32, 9.24],
    "Kosovo": [78.03, 63.81, 16.94, 7.32],
    "Réunion": [83.55, 69.14, 22.24, 10.91],
    "Germany": [81.38, 66.72, 19.82, 9.06],
    "Martinique": [82.56, 68.41, 21.47, 10.54],
    "Israel": [82.41, 67.81, 20.86, 9.73],
    "Belgium": [82.11, 67.48, 20.50, 9.65],
    "Luxembourg": [82.23, 68.03, 20.96, 9.63],
    "Slovenia": [81.60, 66.85, 19.78, 9.21],
    "Iceland": [82.69, 67.85, 20.77, 9.29],
    "Singapore": [83.74, 69.00, 21.87, 10.74],
    "Austria": [81.96, 67.29, 20.12, 9.29],
    "Jersey": [79.71, 65.61, 18.43, 8.23],
    "Ireland": [82.41, 67.72, 20.49, 9.41],
    "Greece": [81.86, 67.20, 19.92, 9.53],
    "Bahrain": [81.28, 66.94, 19.55, 9.01],
    "Denmark": [81.93, 67.26, 19.85, 9.06],
    "Spain": [83.67, 68.96, 21.54, 10.11],
    "Netherlands": [82.16, 67.53, 20.11, 8.94],
    "Japan": [84.71, 69.96, 22.49, 10.95],
    "Oman": [80.03, 66.04, 18.53, 8.16],
    "Hong Kong": [85.51, 70.72, 23.19, 11.45],
    "Sweden": [83.26, 68.50, 20.92, 9.63],
    "Faroe Islands": [80.18, 65.86, 18.26, 7.91],
    "Australia": [83.92, 69.27, 21.65, 10.00],
    "Malta": [83.30, 69.08, 21.42, 10.41],
    "Italy": [83.72, 68.98, 21.31, 9.77],
    "Macau": [83.08, 68.37, 20.70, 8.75],
    "Switzerland": [83.95, 69.31, 21.51, 9.97],
    "Norway": [83.31, 68.56, 20.75, 9.28],
    "Cyprus": [81.65, 66.97, 19.14, 8.62],
    "Kuwait": [80.41, 66.22, 18.35, 7.40],
    "Guernsey": [83.27, 68.91, 20.91, 9.82],
    "Maldives": [81.04, 66.51, 18.46, 7.92],
    "French Polynesia": [84.07, 69.65, 21.50, 10.23],
    "Andorra": [84.04, 69.62, 21.47, 10.19],
    "Qatar": [82.37, 67.88, 19.61, 8.57],
    "South Korea": [84.33, 69.63, 21.32, 10.45],
    "United Arab Emirates": [82.91, 68.45, 20.01, 8.23]
};

export const COUNTRY_LIST = Object.keys(LIFE_EXPECTANCY_DATA).sort();

export function calculateLifeExpectancy(currentAge: number | null, country: string = "Germany"): number {
    if (currentAge === null || currentAge === undefined) return 80;

    // Fallback to Germany if country not found, or World if Germany missing
    const dataPoints = LIFE_EXPECTANCY_DATA[country] || LIFE_EXPECTANCY_DATA["Germany"] || LIFE_EXPECTANCY_DATA["World"];
    
    // Format: [LE_Birth, Remaining_at_15, Remaining_at_65, Remaining_at_80]
    // We need to convert these to Total Life Expectancy points
    const points = [
        { age: 0, expectancy: dataPoints[0] },
        { age: 15, expectancy: 15 + dataPoints[1] },
        { age: 65, expectancy: 65 + dataPoints[2] },
        { age: 80, expectancy: 80 + dataPoints[3] }
    ];

    // Find segment
    for (let i = 0; i < points.length - 1; i++) {
        const p1 = points[i];
        const p2 = points[i + 1];
        
        if (currentAge >= p1.age && currentAge < p2.age) {
            const t = (currentAge - p1.age) / (p2.age - p1.age);
            return p1.expectancy + t * (p2.expectancy - p1.expectancy);
        }
    }

    // Above 80
    const lastPoint = points[points.length - 1];
    if (currentAge >= lastPoint.age) {
        // Slope from 65-80 segment
        const prevPoint = points[points.length - 2];
        const slope = (lastPoint.expectancy - prevPoint.expectancy) / (lastPoint.age - prevPoint.age);
        
        const projected = lastPoint.expectancy + (currentAge - lastPoint.age) * slope;
        return Math.max(projected, currentAge + 1.5);
    }

    return 80;
}
